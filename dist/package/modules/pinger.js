"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pinger=void 0;const _1=require("."),engine_1=require("../engine"),PING_INTERVAL_IN_SECONDS=180;class Pinger extends _1.BaseModule{requestModule;lastPingTimestamp=0;constructor(){super("pinger")}async onPoll(){var e=this.byteboost.initializedAt,e=(Date.now()-e)/1e3;if(!(e<PING_INTERVAL_IN_SECONDS)){if(0!==this.lastPingTimestamp)if((Date.now()-this.lastPingTimestamp)/1e3<PING_INTERVAL_IN_SECONDS)return;this.lastPingTimestamp=Date.now();e=await this.requestModule.get(engine_1.BASE_API_URL+"/v1beta/session/ping");401===e.status&&this.byteboost.cleanup(),this.byteboost.debug("DID PING",e)}}boot(){var e=this.byteboost.getModule("request");if(!e)throw new Error("Unable to get request module!");this.requestModule=e,this.receivePolls()}build(){return{}}}exports.Pinger=Pinger;
