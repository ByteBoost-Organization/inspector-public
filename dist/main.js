(()=>{var o={961:(e,t,s)=>{y=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};var y,o,n,r,i,a=i={compressToBase64:function(e){if(null==e)return"";var t=i._compress(e,6,function(e){return o.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,function(e){return c(o,t.charAt(e))})},compressToUTF16:function(e){return null==e?"":i._compress(e,15,function(e){return y(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:i._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){for(var t=i.compress(e),s=new Uint8Array(2*t.length),o=0,n=t.length;o<n;o++){var r=t.charCodeAt(o);s[2*o]=r>>>8,s[2*o+1]=r%256}return s},decompressFromUint8Array:function(e){if(null==e)return i.decompress(e);for(var t=new Array(e.length/2),s=0,o=t.length;s<o;s++)t[s]=256*e[2*s]+e[2*s+1];var n=[];return t.forEach(function(e){n.push(y(e))}),i.decompress(n.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,function(e){return n.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,function(e){return c(n,t.charAt(e))}))},compress:function(e){return i._compress(e,16,function(e){return y(e)})},_compress:function(e,t,s){if(null==e)return"";for(var o,n,r,i,a={},c={},l="",u=2,h=3,d=2,p=[],v=0,b=0,g=0;g<e.length;g+=1)if(r=e.charAt(g),Object.prototype.hasOwnProperty.call(a,r)||(a[r]=h++,c[r]=!0),i=l+r,Object.prototype.hasOwnProperty.call(a,i))l=i;else{if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(o=0;o<d;o++)v<<=1,b==t-1?(b=0,p.push(s(v)),v=0):b++;for(n=l.charCodeAt(0),o=0;o<8;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1}else{for(n=1,o=0;o<d;o++)v=v<<1|n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n=0;for(n=l.charCodeAt(0),o=0;o<16;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1}0==--u&&(u=Math.pow(2,d),d++),delete c[l]}else for(n=a[l],o=0;o<d;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1;0==--u&&(u=Math.pow(2,d),d++),a[i]=h++,l=String(r)}if(""!==l){if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(o=0;o<d;o++)v<<=1,b==t-1?(b=0,p.push(s(v)),v=0):b++;for(n=l.charCodeAt(0),o=0;o<8;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1}else{for(n=1,o=0;o<d;o++)v=v<<1|n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n=0;for(n=l.charCodeAt(0),o=0;o<16;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1}0==--u&&(u=Math.pow(2,d),d++),delete c[l]}else for(n=a[l],o=0;o<d;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1;0==--u&&(u=Math.pow(2,d),d++)}for(n=2,o=0;o<d;o++)v=v<<1|1&n,b==t-1?(b=0,p.push(s(v)),v=0):b++,n>>=1;for(;;){if(v<<=1,b==t-1){p.push(s(v));break}b++}return p.join("")},decompress:function(t){return null==t?"":""==t?null:i._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,s){for(var o,n,r,i,a,c,l=[],u=4,h=4,d=3,p="",v=[],b={val:s(0),position:t,index:1},g=0;g<3;g+=1)l[g]=g;for(n=0,i=Math.pow(2,2),a=1;a!=i;)r=b.val&b.position,b.position>>=1,0==b.position&&(b.position=t,b.val=s(b.index++)),n|=(0<r?1:0)*a,a<<=1;switch(n){case 0:for(n=0,i=Math.pow(2,8),a=1;a!=i;)r=b.val&b.position,b.position>>=1,0==b.position&&(b.position=t,b.val=s(b.index++)),n|=(0<r?1:0)*a,a<<=1;c=y(n);break;case 1:for(n=0,i=Math.pow(2,16),a=1;a!=i;)r=b.val&b.position,b.position>>=1,0==b.position&&(b.position=t,b.val=s(b.index++)),n|=(0<r?1:0)*a,a<<=1;c=y(n);break;case 2:return""}for(o=l[3]=c,v.push(c);;){if(e<b.index)return"";for(n=0,i=Math.pow(2,d),a=1;a!=i;)r=b.val&b.position,b.position>>=1,0==b.position&&(b.position=t,b.val=s(b.index++)),n|=(0<r?1:0)*a,a<<=1;switch(c=n){case 0:for(n=0,i=Math.pow(2,8),a=1;a!=i;)r=b.val&b.position,b.position>>=1,0==b.position&&(b.position=t,b.val=s(b.index++)),n|=(0<r?1:0)*a,a<<=1;l[h++]=y(n),c=h-1,u--;break;case 1:for(n=0,i=Math.pow(2,16),a=1;a!=i;)r=b.val&b.position,b.position>>=1,0==b.position&&(b.position=t,b.val=s(b.index++)),n|=(0<r?1:0)*a,a<<=1;l[h++]=y(n),c=h-1,u--;break;case 2:return v.join("")}if(0==u&&(u=Math.pow(2,d),d++),l[c])p=l[c];else{if(c!==h)return null;p=o+o.charAt(0)}v.push(p),l[h++]=o+p.charAt(0),o=p,0==--u&&(u=Math.pow(2,d),d++)}}};function c(e,t){if(!r[e]){r[e]={};for(var s=0;s<e.length;s++)r[e][e.charAt(s)]=s}return r[e][t]}void 0!==(s=function(){return a}.call(t,s,t,e))&&(e.exports=s)},607:function(e,t,s){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){e[o=void 0===o?s:o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(397),t)},782:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAXIMUM_SESSION_REQUEST_RESPONSE_TIME=t.MINIMUM_TIME_BETWEEN_FORCED_SCREENSHOTS=t.MINIMUM_TIME_BETWEEN_SCREENSHOTS=t.CLICK_GROUP_INTERVAL=t.CLICK_GROUP_RADIUS=t.WATCHER_TIMEOUT_CHANGE_THRESHOLD=t.WATCHER_SPEED_UP_STEP=t.WATCHER_CYCLES_BETWEEN_EVAL=t.WATCHER_MAX_TIMEOUT=t.WATCHER_MIN_TIMEOUT=t.WATCHER_STARTING_TIMEOUT=void 0,t.WATCHER_STARTING_TIMEOUT=500,t.WATCHER_MIN_TIMEOUT=100,t.WATCHER_MAX_TIMEOUT=4e3,t.WATCHER_CYCLES_BETWEEN_EVAL=5,t.WATCHER_SPEED_UP_STEP=40,t.WATCHER_TIMEOUT_CHANGE_THRESHOLD=100,t.CLICK_GROUP_RADIUS=20,t.CLICK_GROUP_INTERVAL=400,t.MINIMUM_TIME_BETWEEN_SCREENSHOTS=5e3,t.MINIMUM_TIME_BETWEEN_FORCED_SCREENSHOTS=500,t.MAXIMUM_SESSION_REQUEST_RESPONSE_TIME=1250},850:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ByteBoost=t.BASE_API_URL=void 0;var o=s(356),n=s(230),r=s(258),i=s(81);const c=s(429);var a=s(410),l=s(882);const u=s(601);var h=s(958);const d=s(252);var p=s(670),v=s(592),s=s(872);t.BASE_API_URL="https://external.api.byteboost.io";const b={DEBUG:"#5075DA",INFO:"#50DA7C",ERROR:"#DA6550",WARN:"#DAB250"},g="__byteboost.io__persistant_data",y=g+"_m",f=[o.EventBus,h.PainpointTracker,r.RequestModule,n.Logger,i.ErrorModule,a.Navigations,p.Clicks,v.Screenshots,s.SessionRequests,l.Pinger];t.ByteBoost=class{modules;performance;navigator;initializedAt=0;apiKey;obfuscateLevel;_devMode=!1;minified;painpoints;constructor(e){"_byteboost_dev"in window&&"boolean"==typeof window._byteboost_dev&&!0===window._byteboost_dev&&(this._devMode=!0),this.info("starting",e),this.minified=e.minified,this.info("running "+(this.minified?"minified":"unminified")),this.painpoints=e.painpoints,this.obfuscateLevel=e.obfuscateLevel,this.navigator=window.navigator,this.performance=window.performance||self.performance,this.apiKey=e.apiKey;let t=this.getPersistantData();!1===t&&(t={}),this.modules={};for(var s of f){s=new s;t.hasOwnProperty(s.namespace)?s.unpack(t[s.namespace]):s.onBuildNeeded(),this.modules[s.namespace]={namespace:s.namespace,module:s}}window.addEventListener("beforeunload",m)}handleModuleSync(e){for(var t in this.modules){t=this.modules[t].module;!1!==t.isDataModule&&(this.minified?this.minified&&t.canSync&&t.stopSync():t.startSync(e))}}initializeModules(){for(var e in this.debug("initializing modules"),this.modules){var t=this.modules[e].module;"eventBus"!==e&&t.bindEventBus(this.getModule("eventBus")),t.bootPreload(),t.boot()}this.handleModuleSync(),this.initializedAt=Date.now()}onEventBusPoll(){for(const e in this.modules)this.modules[e].module.garbageCollector.collect()}isGatheringSession=!1;async unminify(){if(this.minified&&!this.isGatheringSession){if(this.isGatheringSession=!0,!await(0,d.askForSession)())return this.purge();this.minified=!1,this.isGatheringSession=!1,this.handleModuleSync(!0)}}getModule(e){if(this.modules[e])return this.modules[e].module}getApiKey(){return this.apiKey}debug(...e){this._devMode&&console.log("%c[byteboost]","color:"+b.DEBUG+";font-weight:bold;",...e)}info(...e){this._devMode&&console.log("%c[byteboost]","color:"+b.INFO+";font-weight:bold;",...e)}warn(...e){this._devMode&&console.log("%c[byteboost]","color:"+b.WARN+";font-weight:bold;",...e)}error(...e){this._devMode&&console.log("%c[byteboost]","color:"+b.ERROR+";font-weight:bold;",...e)}async compilePersistantData(){var e,t={};for(e in this.modules){var s=await this.modules[e].module.pack();t[e]=s}return t}async purge(){await this.cleanup(),localStorage.removeItem(g),localStorage.removeItem(y)}getPersistantData(){try{var e=JSON.parse((0,u.uncompressString)(localStorage.getItem(g))),t=JSON.parse(localStorage.getItem(y)),s=Date.now(),o=(0,c.uncompressJSON)(e,t);if(this.debug("Uncompression took:",Date.now()-s,"ms"),o)return o;throw"unable to compress"}catch(e){return!1}}logStateItems(){let e=0;for(const s in this.modules){var t=this.modules[s].module;e+=t.garbageCollector.getStateCount()}console.log("byteboost state:",e)}async getDump(){var e=await this.compilePersistantData(),t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(JSON.stringify(e,null,2))),t.setAttribute("download","persistant.json"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}async cleanup(){try{for(var e in this.debug("cleaning up"),this.modules){var t=this.modules[e].module;t.cleanup(),t.isDataModule&&t.forceSend()}var s=await this.compilePersistantData(),o=Date.now(),[n,r]=(0,c.compressJSON)(s),i=(this.debug("Compression took:",Date.now()-o,"ms"),JSON.stringify(n)),a=JSON.stringify(r),i=(0,u.compressString)(i);try{localStorage.setItem(g,i),localStorage.setItem(y,a)}catch(e){this.error("Unable to save data to local storage",e)}window.removeEventListener("beforeunload",m),this.info("terminated"),window._byteboost&&delete window._byteboost}catch(e){this._devMode&&console.log("cleanup error",e)}}getObfuscateLevel(){return this.obfuscateLevel}};const m=async()=>{await window._byteboost.cleanup()}},264:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GarbageCollector=void 0;t.GarbageCollector=class{myModule;optimization;isOptimizing=!1;constructor(e){this.myModule=e}setOptimization(e){this.isOptimizing=!0,this.optimization=e}collect(){if(this.isOptimizing)for(var[e,t]of Object.entries(this.optimization))this.myModule.state[e].length>t.count&&(this.myModule.state[e]=this.myModule.state[e].slice(Math.floor(this.myModule.state[e].length/2)))}getStateCount(){let e=0;for(const t in this.optimization)e+=this.myModule.state[t].length;return e}}},397:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDev=t.wrapWindow=void 0;const o=s(850),n=s(252),r=s(924);t.wrapWindow=()=>{if("undefined"!=typeof window&&!window._byteboost&&!window._startingByteboost){const t=async()=>{await(0,r.setupPersistantWorkers)();var e=await(0,n.preflightChecks)();!1!==e&&e?("_byteboost_dev"in window&&"boolean"==typeof window._byteboost_dev&&!0===window._byteboost_dev&&console.log("preflight succeeded"),window._byteboost=new o.ByteBoost({apiKey:window.byteboostKey,startByteboost:t,obfuscateLevel:e.obfuscateLevel,painpoints:e.painpoints,minified:e.minified}),window._byteboost.initializeModules()):("_byteboost_dev"in window&&"boolean"==typeof window._byteboost_dev&&!0===window._byteboost_dev&&console.log("preflight failed"),await(0,r.killPersistantWorkers)())};try{t()}catch(e){}}},(0,t.wrapWindow)();t.isDev=()=>!0},601:function(e,t,s){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=t.uncompressString=t.compressString=t.findCircular=t.removeCircular=void 0;const n=o(s(961));t.removeCircular=function(e){const o=new Map,n=e=>{if(o.set(e,!0),e)for(var[t,s]of Object.entries(e))if("object"==typeof s)if(Array.isArray(s)){if(i(s)){e[t]="[byteboost-3200] circular reference";break}}else o.has(s)?e[t]="[byteboost-3200] circular reference":n(s)};return n(e),e};const r=e=>{if(!e||"object"!=typeof e)return[];for(var t=[],s=[{obj:e,path:[]}];0<s.length;){var{obj:o,path:n}=s.pop();if("object"==typeof o&&null!==o)for(const r in o)s.push({obj:o[r],path:[...n,r]});else t.push(n)}return t},i=e=>{var t=[];for(const o of r(e)){var s=o.join(".");if(t.includes(s))return!0;t.push(s)}return!1};t.findCircular=function(e){let o=!1;const n=new Map,r=e=>{if(n.set(e,!0),!o&&e)for(var[t,s]of Object.entries(e)){if(o)return;if("object"==typeof s)if(Array.isArray(s)){if(i(s)){o=!0;break}}else{if(n.has(s)){o=!0;break}r(s)}}};return r(e),o};t.compressString=e=>null==e?"":n.default.compress(e),t.uncompressString=e=>null==e?"":n.default.decompress(e);t.randomString=t=>{let s="";var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=o.length;for(let e=0;e<t;e++)s+=o.charAt(Math.floor(Math.random()*n));return s}},670:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Clicks=void 0;const o=s(782);var n=s(134);const r=s(601),i=s(580);class a extends n.BaseDataModule{_syncStatus={syncRequestedAt:-1,isSyncing:!1};constructor(){super("clicks"),this.garbageCollector.setOptimization({clicks:{count:150}})}getMousePos(e){var t,s;let o=e?.pageX??-1,n=e?.pageY??-1;return null==e.pageX&&null!=e.clientX&&(t=(s=e.target&&e.target.ownerDocument||document).documentElement,s=s.body,o=e.clientX+(t&&t.scrollLeft||s&&s.scrollLeft||0)-(t&&t.clientLeft||s&&s.clientLeft||0),n=e.clientY+(t&&t.scrollTop||s&&s.scrollTop||0)-(t&&t.clientTop||s&&s.clientTop||0)),{x:o??-1,y:n??-1}}onClick(t){var e=this.state.clicks.find(e=>t.x-o.CLICK_GROUP_RADIUS<e.x&&t.x+o.CLICK_GROUP_RADIUS>e.x&&t.y-o.CLICK_GROUP_RADIUS<e.y&&t.y+o.CLICK_GROUP_RADIUS>e.y&&t.when-o.CLICK_GROUP_INTERVAL<e.when);!e||!0===this._syncStatus.isSyncing&&e.when<this._syncStatus.syncRequestedAt&&-1!==this._syncStatus.syncRequestedAt?this.state.clicks.push(t):(e.count++,this.emit("count_updated",{count:e.count}))}gatherRelevantElementData(e){return{innerHTML:(0,r.compressString)(e.innerHTML),outerHTML:(0,r.compressString)(e?.outerHTML),scrollHeight:e?.scrollHeight,scrollLeft:e?.scrollLeft,scrollTop:e?.scrollTop,scrollWidth:e?.scrollWidth,scrollLeftMax:e?.scrollLeftMax,scrollTopMax:e?.scrollTopMax,clientHeight:e?.clientHeight,clientLeft:e?.clientLeft,clientTop:e?.clientTop,clientWidth:e?.clientWidth,attrId:e.getAttribute("id")??void 0,attrClassName:e.getAttribute("class")??void 0,attrStyle:e.getAttribute("style")??void 0}}getAppropriateClickEvent(e,t){var s=e.target||e.srcElement,e={...this.getMousePos(e),when:t||Date.now(),count:1};return s?(t=s,{...e,element:this.gatherRelevantElementData(t),where:this.byteboost.getModule("navigations")?.getFormattedPath()??"UNKNOWN"}):e}boundedClickListener(e){var t=Date.now(),e=(this.byteboost.getModule("screenshots")?.captureScreenshot(),this.getAppropriateClickEvent(e,t));this.emit("click",e)}boot(){this.on("click",e=>{this.onClick(e)}),document.addEventListener("click",c,{capture:!0})}build(){return{clicks:[]}}cleanup(){document.removeEventListener("click",c)}formatSyncData(){var e;return 0===this.state.clicks.length?{_empty:!0}:(e=(0,i.cloneObject)(this.state),this._syncStatus={isSyncing:!0,syncRequestedAt:Date.now()},e)}onSync(e){e.response.success?(this.state.clicks=this.eventBus.cleanSyncedData(this.state.clicks,e),this._syncStatus={isSyncing:!1,syncRequestedAt:-1}):this.byteboost.error("Unable to sync clicks module.")}}t.Clicks=a;const c=e=>{var t;window._byteboost&&(t=window._byteboost.getModule("clicks"))&&t.boundedClickListener(e)}},81:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorModule=void 0;var o=s(134);const n=s(675),r=s(580);class i extends o.BaseDataModule{screenshots;navigations;constructor(){super("errors"),this.garbageCollector.setOptimization({errors:{count:80}})}processError(e){var t={when:Date.now(),message:"",where:this.navigations.getFormattedPath()};"message"in e.message&&"stack"in e.message?(t.message=e.message.message,t.stack=e.message.stack):t.message=e.message,this.screenshots.captureScreenshot(!0),this.emit("onError",t,n.EVENT_PRIORITY.ERRORS)}handledRejectionError(e){}unhandledRejectionError(e){this.processError({message:e.reason})}boot(){var e=this.byteboost.getModule("screenshots");if(!e)throw new Error("Unable to get screenshots module!");this.screenshots=e;e=this.byteboost.getModule("navigations");if(!e)throw new Error("Unable to get navigations module!");this.navigations=e,window.addEventListener("rejectionhandled ",a),window.addEventListener("unhandledrejection",c),this.on("onError",e=>{this.state.errors.push(e)})}cleanup(){window.removeEventListener("rejectionhandled ",a),window.removeEventListener("unhandledrejection",c)}formatSyncData(){return 0===this.state.errors.length?{_empty:!0}:(0,r.cloneObject)(this.state)}onSync(e){e.response.success?this.state.errors=this.eventBus.cleanSyncedData(this.state.errors,e):this.byteboost.error("Unable to sync error module")}build(){return{errors:[]}}}t.ErrorModule=i;const a=e=>{window._byteboost&&window._byteboost.getModule("errors")?.handledRejectionError(e)},c=e=>{window._byteboost&&window._byteboost.getModule("errors")?.unhandledRejectionError(e)}},356:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=t.ByteEvent=void 0;const o=s(580);var n=s(134);const r=s(397),i=s(601);var a=s(750);const c=s(762),l=s(810);class u{id;payload;eventId;_meta={dispatched:-1};delay;when;priority=0;constructor(e,t,s,o){e=(0,c.toByteId)(e,t);this.when=Date.now(),this.id=e,this.payload=s,this.eventId=`${e}|${Date.now()}|`+(0,i.randomString)(8),this.delay={waited:0,toWait:0,lastPoll:0},o&&(this.priority=o)}isValid(){return!!(this.id&&this.payload&&this.delay&&this.eventId)}setPayload(e){this.payload=e}sharpen(e){return this.id=e.id,this.eventId=e.eventId,this.payload=e.payload,this.delay=e.delay,this._meta=e._meta,this.priority=e.priority,this.when=e.when,this}flatten(){return{id:this.id,payload:(0,o.cloneObject)(this.payload),delay:this.delay,_meta:this._meta,eventId:this.eventId,priority:this.priority,when:this.when}}wait(e){return this.delay.lastPoll=Date.now(),this.delay.toWait=e,this}copy(){return new u("","",{}).sharpen(this.flatten())}}t.ByteEvent=u;class h extends n.BaseModule{polling=!1;middlewares={before:[d,...a.beforeMiddlewares],after:[]};modulesToPoll=[];watcher;_garbage={events:[],eventsStr:[]};constructor(){super("eventBus"),this.watcher=new l.EventBusWatcher(this)}toByteId(e,t){return(0,c.toByteId)(e,t)}dispatch(e,t,s){this.dispatchEvent(new u(e,t,s))}dispatchEvent(e){try{var t;(0,r.isDev)()&&"object"==typeof e.payload&&(0,i.findCircular)(e.payload)?this.byteboost.error("unable to dispatch event. payload has circular properties -> new byte event:",e):((t=e.copy()).payload._eventId=t.eventId,this.state.eventQueue.push(t))}catch(e){this.byteboost.error("Error on dispatch",e)}}listen(e,t,s){null!=this.state.eventListeners&&(e=(0,c.toByteId)(e,t),this.state.eventListeners.hasOwnProperty(e)?this.state.eventListeners[e].push(s):this.state.eventListeners[e]=[s])}getNextEvent(){return this.state.eventQueue[0]}removeNextEvent(){return this.state.eventQueue.shift()}before(e){let t=!0;for(var s of this.middlewares.before)if(!1===s(e)){t=!1;break}return t}addModulePolling(e){this.modulesToPoll.push(e)}enginePoll(){for(const e of this.modulesToPoll)e.onPoll();this.byteboost.onEventBusPoll()}after(e){}async sleep(t){await new Promise(e=>{setTimeout(()=>{e()},t)})}runEventContext(){let o=this.state.eventQueue.slice();const e=()=>{if(0===o.length)return null;let t=o[o.length-1],s=o.length-1;for(let e=0;e<o.length;e++)o[e].priority>t.priority&&(t=o[e],s=e);return o.splice(s,1),this.before(t)?t:e()};let t=e();var s;t&&(-1===(s=this.state.eventQueue.findIndex(e=>e.eventId===t.eventId))?this.byteboost.error("Unable to find event in event queue",t):(this.state.eventQueue.splice(s,1),this.state.processingEvents.push(t)))}dispatchNextProcessedEvent(){if(0===this.state.processingEvents.length)return null;var e,t=this.state.processingEvents[0];if(!(t.id in this.state.eventListeners)||0===this.state.eventListeners[t.id].length)return this.byteboost.warn("no listeners found for event:",t),null;this.byteboost.debug("dispatching event:",t);for(e of this.state.eventListeners[t.id])e(t.payload);return t._meta={dispatched:Date.now()},this.addHandledEvent(t),this.state.processingEvents.shift(),t}async poll(){var e;await this.sleep(this.watcher.getPollTime()),this.polling&&(this.watcher.onNewPoll(),null==this.state.eventListeners?(this.byteboost.error("[EventBus] No event listeners. Stopping polling"),this.polling=!1):(null!==(e=this.dispatchNextProcessedEvent())&&this.after(e),this.runEventContext(),this.enginePoll(),this.poll()))}declareGarbage(t,s){this._garbage.events.find(e=>t===e.app&&s===e.id)||(this._garbage.events.push({app:t,id:s}),this._garbage.eventsStr.push((0,c.toByteId)(t,s)))}removeHandledEvents(t){this.state.handledEvents=this.state.handledEvents.filter(e=>!t.includes(e.eventId))}getHandledEvent(t){if(t)return this.state.handledEvents.find(e=>e.eventId===t)}addHandledEvent(e){this.isGarbageEvent(e)||this.byteboost.minified||this.state.handledEvents.push(e.flatten())}cleanSyncedData(e,s){if(0===e.length)return e;let o=[];e=e.filter(e=>{var t,e=this.getHandledEvent(e._eventId);return!!e&&((t=!(e._meta.dispatched>s.data._syncRequestedAt))&&o.push(e.eventId),!t)});return this.removeHandledEvents(o),e}isGarbageEvent(e){return this._garbage.eventsStr.includes(e.id)}removeGarbageEvents(e){return e.filter(e=>{return!this._garbage.eventsStr.includes(e.id)})}packEventList(e){e=e.slice(),e=(0,i.removeCircular)((0,o.cloneObject)(e));return this.removeGarbageEvents(e)}unpackEventList(e){return e&&0!==e.length?e.map(e=>new u("","",{}).sharpen(e)):[]}boot(){this.polling=!0,this.declareGarbage("request","sync"),this.poll()}unpack(e){e.eventQueue=this.unpackEventList(e.eventQueue),e.processingEvents=this.unpackEventList(e.processingEvents),e.eventListeners={},super.unpack(e)}build(){return{eventQueue:[],processingEvents:[],eventListeners:{},lastEventId:"",handledEvents:[]}}async pack(){var e=this.packEventList(this.state.eventQueue),t=this.packEventList(this.state.processingEvents),s=this.state.handledEvents.slice(),s=(0,i.removeCircular)((0,o.cloneObject)(s));return{...this.state,eventListeners:null,eventQueue:e,processingEvents:t,handledEvents:s}}cleanup(){this.polling=!1}}t.EventBus=h;const d=e=>{if(!e.isValid()){var t=window._byteboost.getModule("eventBus");if(!t)return window._byteboost.error("Unable to find event bus module"),!1;t.byteboost.warn("Next event is invalid. Removing it",e),t.removeNextEvent()}return!0}},750:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beforeMiddlewares=void 0;t.beforeMiddlewares=[e=>0===e.delay.toWait||(e.delay.waited=e.delay.waited+(Date.now()-e.delay.lastPoll),e.delay.lastPoll=Date.now(),e.delay.waited>e.delay.toWait)]},762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toByteId=void 0;t.toByteId=(e,t)=>e+":"+t},810:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventBusWatcher=void 0;const o=s(782);t.EventBusWatcher=class{eventBus;timeout=-1;startTime=-1;cycle=0;cyclesTrackingInterval=o.WATCHER_CYCLES_BETWEEN_EVAL;utopiaInterval={cycles:-1,time:-1};constructor(e){this.eventBus=e,this.setTimeout(o.WATCHER_STARTING_TIMEOUT)}setTimeout(e){(e=e>o.WATCHER_MAX_TIMEOUT?o.WATCHER_MAX_TIMEOUT:e)<o.WATCHER_MIN_TIMEOUT&&(e=o.WATCHER_MIN_TIMEOUT),this.timeout=e,this.cyclesTrackingInterval=this.getCycleTrackingInterval(e),this.utopiaInterval.time=this.timeout*this.cyclesTrackingInterval,this.utopiaInterval.cycles=Math.floor(this.utopiaInterval.time/this.timeout)}getCycleTrackingInterval(e){return 3e3<e?2:Math.floor(800/e+4)}evaluate(){var e;-1!==this.startTime&&((e=Date.now()-this.startTime-this.utopiaInterval.time)>=o.WATCHER_TIMEOUT_CHANGE_THRESHOLD?this.setTimeout(this.timeout+e/10):this.setTimeout(this.timeout-o.WATCHER_SPEED_UP_STEP)),this.startTime=Date.now()}reset(){this.cycle=0,this.startTime=-1}onNewPoll(){this.cycle++,1e6<this.cycle?this.reset():this.cycle%this.cyclesTrackingInterval==0&&this.evaluate()}getPollTime(){return this.timeout}}},134:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDataModule=t.BaseModule=void 0;const o=s(356),n=s(580),r=s(850),i=s(675),a=s(264);class c{state;namespace;isPolling=!1;isDataModule=!1;_eventBus;garbageCollector;constructor(e){this.namespace=e,this.garbageCollector=new a.GarbageCollector(this)}get byteboost(){return window._byteboost}bindEventBus(e){this._eventBus=e}get eventBus(){if("eventBus"===this.namespace)throw Error("Cannot access EventBus on EventBus");return this._eventBus}emit(e,t,s){this.eventBus.dispatchEvent(new o.ByteEvent(this.namespace,e,t,s))}on(e,t){this.eventBus.listen(this.namespace,e,t)}onPoll(){}receivePolls(){var e=this.byteboost.getModule("eventBus");if(!e)throw new Error("Unable to find the event bus module. unable to start module polling.");e.addModulePolling(this),this.isPolling=!0}bootPreload(){this.garbageCollector.collect()}cleanup(){}onBuildNeeded(){var e=this.build();this.state={updated:Date.now(),...e}}unpack(e){this.state=e,this.bindDefaultPersistantData(e)}bindDefaultPersistantData(e){this.state.updated=Date.now()}async pack(){return this.state}}t.BaseModule=c;t.BaseDataModule=class extends c{syncPathName;isDataModule=!0;canSync=!0;constructor(e){super(e),this.syncPathName=this.namespace}formatSyncData(){return(0,n.cloneObject)(this.state)}baseFormatSyncData(e){var t=this.formatSyncData();return!0===t?._empty?(this.byteboost.debug("will dispatch onSyncSkipped",this.namespace),e.dispatchEvent(new o.ByteEvent(this.namespace,"onSyncSkipped",t,i.EVENT_PRIORITY.ON_SYNC_SKIPPED).wait(15e3)),null):{data:t,_syncRequestedAt:Date.now()}}sync(e,t){var s;this.canSync&&(s=this.baseFormatSyncData(e))&&e.dispatchEvent(new o.ByteEvent("request","sync",{path:r.BASE_API_URL+"/v1beta/events/"+(this.syncPathName??this.namespace),event:new o.ByteEvent(this.namespace,"onSync",{},i.EVENT_PRIORITY.SYNC_REQUEST_CALLBACK).flatten(),data:s},i.EVENT_PRIORITY.SYNC_REQUEST).wait(t?0:15e3))}stopSync(){this.canSync=!1}startSync(e){this.canSync=!0,this.doSync(e)}doSync(e){const t=this.byteboost.getModule("eventBus");if(!t)throw"[byteboost] un-able to get eventBus";t.declareGarbage(this.namespace,"onSync"),t.declareGarbage(this.namespace,"onSyncSkipped"),t.listen(this.namespace,"onSyncSkipped",e=>{!0===e?._empty&&this.sync(t)}),t.listen(this.namespace,"onSync",e=>{this.onSync(e),this.sync(t)}),this.sync(t,e)}async forceSend(){var e,t;this.canSync&&(e=this.byteboost.getModule("eventBus"))&&(e=this.baseFormatSyncData(e))&&(t=this.byteboost.getModule("request"))&&t.post(r.BASE_API_URL+"/v1beta/events/"+this.syncPathName,e.data)}}},230:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.ConsoleType=void 0;var o,n=s(134);const r=s(397),i=s(601),a=s(675),c=s(580);(s=o||(t.ConsoleType=o={})).DEBUG="debug",s.ERROR="error",s.INFO="info",s.LOG="log",s.WARN="warn",s.DIR="dir",s.DIRXML="dirxml",s.TABLE="table",s.TRACE="trace",s.GROUP="group",s.GROUPCOLLAPSED="groupCollapsed",s.GROUPEND="groupEnd",s.CLEAR="clear",s.COUNT="count",s.COUNTRESET="countReset",s.ASSERT="assert",s.PROFILE="profile",s.PROFILEEND="profileEnd",s.TIME="time",s.TIMELOG="timeLog",s.TIMEEND="timeEnd",s.TIMESTAMP="timeStamp",s.CONTEXT="context",s.CREATETASK="createTask",s.MEMORY="memory";class l extends n.BaseDataModule{logTrackingEnabled=!0;minLogsLength=200;maxLogsLength=400;bindedConsoleMethods=[];navigations;constructor(){super("logger"),this.syncPathName="console"}cleanCircularLogObjects(){for(var e in console)e in this.state&&(this.state[e]=(0,i.removeCircular)((0,c.cloneObject)(this.state[e])))}obfuscateLogDetail(e){return this.navigations&&(1===this.navigations.obfuscateLevel?e.value=e.value.map(e=>{if("string"==typeof e)return"OBFUSCATED: "+(0,i.randomString)(e.length)}):2===this.navigations.obfuscateLevel&&(e.value=e.value.map(e=>"string"==typeof e?"OBFUSCATED (STR): "+(0,i.randomString)(e.length):`OBFUSCATED (${typeof e})`))),e}handleMemoryFor(e){var t=this.state[e];t.logs.length>this.maxLogsLength&&(this.byteboost.debug("removing logs",e),t.logs=t.logs.slice(t.logs.length-this.minLogsLength,t.logs.length),t.count=t.logs.length)}async trackLog(e,...t){(0,r.isDev)()&&"string"==typeof t[0]&&t[0].includes("[byteboost]")||(t={value:t,when:Date.now(),kind:e,where:this.navigations?this.navigations.getFormattedPath():window.location.pathname},this.emit("log",t,a.EVENT_PRIORITY.LOGGER))}boot(){const n=this;var e,t=this.byteboost.getModule("navigations");for(e in t&&(this.navigations=t),this.eventBus.listen("logger","log",e=>{var t=e.kind;this.state[t]||(this.state[t]={count:0,logs:[]}),this.state[t].count++,this.state[t].logs.push(this.obfuscateLogDetail(e)),this.handleMemoryFor(t)}),this.byteboost.debug("tracking logs"),console)e=e,console[e]=function(t,s,o){if(s)return function(...e){s.apply(t,Array.prototype.slice.apply(e)),n.logTrackingEnabled&&n.trackLog(o,...e)}}(console,console[e],e)}build(){for(var e in console)console[e]&&this.bindedConsoleMethods.push(e);var t,s={};for(t of this.bindedConsoleMethods)s[t]={logs:[],count:0};return s}async pack(){return this.cleanCircularLogObjects(),this.state}cleanup(){this.logTrackingEnabled=!1,this.byteboost.debug("stopped tracking logs")}formatSyncData(){var e,t={logs:[]};for(e in o){var s=this.state[e.toLowerCase()];!s||s.logs.length<=0||("clear"===e.toLowerCase()?t.logs=[...t.logs,...s.logs.map(e=>({...e,value:"CONSOLE_CLEAR"}))]:t.logs=[...t.logs,...s.logs.map(e=>({...e,value:e.value.map(e=>{if("object"==typeof e)try{return JSON.stringify(e)}catch(e){}return e}).join("").replace(/\n/g,"[[{{NEW_LINE}}]]")}))])}return 0===t.logs.length?{_empty:!0}:t}onSync(e){if(e.response.success)for(var t in o){t=this.state[t.toLowerCase()];!t||0===t.count&&0===t.logs.length||(t.logs=this.eventBus.cleanSyncedData(t.logs,e),t.count=t.logs.length)}else this.byteboost.error("Unable to sync logger module.")}}t.Logger=l},410:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Navigations=void 0;var o=s(134);const n=s(580);class r extends o.BaseDataModule{lastScreenshotTime=-1;_obfuscateLevel=-1;constructor(){super("navigations"),this.garbageCollector.setOptimization({navigations:{count:200}})}get obfuscateLevel(){if(-1===this._obfuscateLevel)throw new Error("Obfuscate level is unset");return this._obfuscateLevel}handlePath(){let e=window.location.pathname;var t,s;0===e.length&&(e="/"),this.state.currentPath.pathname!==e&&(t=Date.now(),s=(0,n.cloneObject)(this.state.currentPath),this.state.currentPath.pathname=e,this.byteboost.debug("path changed!",this.state.currentPath),this.byteboost.getModule("screenshots")?.captureScreenshot(!0),this.emit("pathUpdate",{from:s.pathname,to:this.state.currentPath.pathname,when:t}))}getFormattedPath(){return this.state.currentPath.pathname}onPoll(){this.handlePath()}boot(){this._obfuscateLevel=this.byteboost.getObfuscateLevel(),this.receivePolls(),this.on("pathUpdate",e=>{this.state.navigations.push(e)})}formatSyncData(){var e;return 0===this.state.navigations.length?{_empty:!0}:(delete(e=(0,n.cloneObject)(this.state)).currentPath,e)}onSync(e){e.response.success?this.state.navigations=this.eventBus.cleanSyncedData(this.state.navigations,e):this.byteboost.error("Unable to sync core module.")}build(){return{navigations:[],currentPath:{pathname:"/"}}}}t.Navigations=r},958:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PainpointTracker=void 0;var o=s(134);const n=s(762);class r extends o.BaseModule{painpoints={};constructor(){super("painpointTracker")}painpointReached(){this.byteboost.minified&&(this.byteboost.debug("painpoint reached, spinning up full engine"),this.byteboost.unminify())}checkComparisonPainpoint(e,t,s){for(const r of t.comparisons){var o=r.getter.split(".");if(o[0]in s){var o=s[o[0]],n=typeof r.matcher;if(n!=typeof o)return;if("number"==n&&r.matcher>=o)return this.painpointReached()}}}checkCountPainpoint(e,t,s){if(1===t.count)return this.painpointReached();let o=this.state.tracked[e];o?o.count++:o={count:1,kind:"count"},o.count>=t.count?this.painpointReached():this.state.tracked[e]=o}onEventDispatched(e,t){if(this.byteboost.minified&&e in this.painpoints){var s=this.painpoints[e];switch(s.kind){case"count":this.checkCountPainpoint(e,s,t);break;case"comparison":this.checkComparisonPainpoint(e,s,t)}}}boot(){for(const e of this.byteboost.painpoints){const t=(0,n.toByteId)(e.event.namespace,e.event.name);this.painpoints[(0,n.toByteId)(e.event.namespace,e.event.name)]=e,this.eventBus.listen(e.event.namespace,e.event.name,e=>{this.onEventDispatched(t,e)})}}build(){return{tracked:{}}}}t.PainpointTracker=r},882:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pinger=void 0;var o=s(134);const n=s(850);class r extends o.BaseModule{requestModule;lastPingTimestamp=0;constructor(){super("pinger")}async onPoll(){if(!this.byteboost.minified){var e=this.byteboost.initializedAt,e=(Date.now()-e)/1e3;if(!(e<180)){if(0!==this.lastPingTimestamp)if((Date.now()-this.lastPingTimestamp)/1e3<180)return;this.lastPingTimestamp=Date.now();e=await this.requestModule.get(n.BASE_API_URL+"/v1beta/session/ping");401===e.status&&this.byteboost.cleanup(),this.byteboost.debug("DID PING",e)}}}boot(){var e=this.byteboost.getModule("request");if(!e)throw new Error("Unable to get request module!");this.requestModule=e,this.receivePolls()}build(){return{}}}t.Pinger=r},258:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestModule=void 0;var o=s(134);const n=s(356);class r extends o.BaseModule{persistantHeaders={};lastPostTimestamp=0;constructor(){super("request")}isSuccessResponse(e){return 199<e&&e<300}async post(e,t){this.lastPostTimestamp=Date.now();try{var s=await fetch(e,{credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json",...this.persistantHeaders},method:"POST",body:JSON.stringify(t)});try{var o=await s.json();return this.isSuccessResponse(s.status)?{status:s.status,body:o,success:!0}:{status:s.status,body:o,success:!1}}catch(e){return this.isSuccessResponse(s.status)?{status:s.status,body:{},success:!0}:(this.byteboost.error("Unexpected post request error."),{status:s.status,body:s.body,success:!1})}}catch(e){return this.byteboost.error("Unexpected post request error."),{status:500,body:{},success:!1}}}async get(e){var e=await fetch(e,{credentials:"include",headers:{...this.persistantHeaders,Accept:"application/json"}}),t=await e.json();return this.isSuccessResponse(e.status)?{status:e.status,body:t,success:!0}:{status:e.status,body:t,success:!1}}boot(){this.persistantHeaders={"X-Auth-Token":this.byteboost.getApiKey()},this.on("get",async e=>{var t=await this.get(e.path),e=new n.ByteEvent("","",{}).sharpen(e.event);e.setPayload(t),this.eventBus.dispatchEvent(e)}),this.on("sync",async e=>{var t=await this.post(e.path,e.data.data),s=new n.ByteEvent("","",{}).sharpen(e.event),t={response:t,responseTimestamp:Date.now(),data:e.data};s.setPayload(t),this.eventBus.dispatchEvent(s)})}build(){return{apiKey:""}}}t.RequestModule=r},592:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Screenshots=void 0;const n=s(782);var o=s(134);const r=s(601),i=s(765);class a extends o.BaseDataModule{screenshotWorker;lastScreenshotTime=-1;_obfuscateLevel=-1;constructor(){super("screenshots"),this.garbageCollector.setOptimization({screenshots:{count:150}})}get obfuscateLevel(){if(-1===this._obfuscateLevel)throw new Error("Obfuscate level is unset");return this._obfuscateLevel}async captureScreenshot(e){try{var t,s,o=Date.now();!0===e&&o-n.MINIMUM_TIME_BETWEEN_FORCED_SCREENSHOTS<this.lastScreenshotTime||!e&&o-n.MINIMUM_TIME_BETWEEN_SCREENSHOTS<this.lastScreenshotTime||(this.lastScreenshotTime=o,this.byteboost.debug("capturing screenshot"),t=(new XMLSerializer).serializeToString(document),s=new TextEncoder,this.screenshotWorker.emit("screenshot:parse",{document:s.encode(t),when:o,where:this.byteboost.getModule("navigations")?.getFormattedPath()??"UNKNOWN",obfuscateLevel:this.obfuscateLevel}))}catch(e){this.byteboost.warn("Unable to process screenshot. Error: "+e?.toString())}}onScreenshotFromWorker(e){e={when:e.when,where:e.where,compressed:(0,r.compressString)((new TextDecoder).decode(e.document))};this.state.screenshots.push(e)}boot(){this._obfuscateLevel=this.byteboost.getObfuscateLevel(),this.screenshotWorker=new i.WebWorker("screenshot-parser"),this.screenshotWorker.on("screenshot:parsed",e=>{this.byteboost.debug("got parsed screenshot"),this.onScreenshotFromWorker(e)})}build(){return{screenshots:[]}}cleanup(){this.screenshotWorker&&this.screenshotWorker.kill()}formatSyncData(){return 0===this.state.screenshots.length?{_empty:!0}:this.state}onSync(e){e.response.success?this.state.screenshots=this.eventBus.cleanSyncedData(this.state.screenshots,e):this.byteboost.error("Unable to sync screenshots module.")}}t.Screenshots=a},872:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionRequests=void 0;var o=s(134);const n=s(580),r=s(924);class i extends o.BaseDataModule{networkTracker;_obfuscateLevel=-1;constructor(){super("session_requests"),this.syncPathName="requests",this.garbageCollector.setOptimization({requests:{count:500}})}get obfuscateLevel(){if(-1===this._obfuscateLevel)throw new Error("Obfuscate level is unset");return this._obfuscateLevel}onPoll(){this.networkTracker.emit("requests:get")}handleRequests(e){for(const t of e.requests)0===t.referrer.length&&(t.referrer=window.location.toString()),t.method=t.method.toLowerCase(),this.state.requests.push({request:t})}boot(){this._obfuscateLevel=this.byteboost.getObfuscateLevel(),this.receivePolls();var e=(0,r.getPersistantWorker)("network-tracker");e&&(this.networkTracker=e,this.networkTracker.emit("obfuscate_level",this.obfuscateLevel),this.networkTracker.on("requests:get",e=>{0!==e.length&&this.emit("requests",{requests:e})})),this.on("requests",e=>{this.handleRequests(e)})}build(){return{requests:[]}}formatSyncData(){var e;return 0===this.state.requests.length?{_empty:!0}:((e=(0,n.cloneObject)(this.state)).requests=e.requests.map(e=>e.request),e)}onSync(e){e.response.success?this.state.requests=this.eventBus.cleanSyncedData(this.state.requests,e):this.byteboost.error("Unable to sync session requests module.")}}t.SessionRequests=i},252:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.askForSession=s.preflightChecks=void 0;const r=t(782),i=t(850),a=()=>{localStorage.removeItem("bb_sess")};s.preflightChecks=async()=>{if(void 0===window.performance||void 0===window.performance.now)return!1;try{window.performance.now()}catch(e){return!1}if(!0===window._startingByteboost)return!1;try{if(!("DOMParser"in window))return!1;if(!("TextEncoder"in window&&"TextDecoder"in window))return!1;if(!("XMLSerializer"in window))return!1;new XMLSerializer}catch(e){return!1}if(!window.byteboostKey){var e=document.querySelector("[data-byteboost-key]");if(!e)return!1;e=e.getAttribute("data-byteboost-key");if(!e)return!1;window.byteboostKey=e}if(window._startingByteboost=!0,!o())return!1;let t=!0;if("true"===localStorage.getItem("bb_sess")){if(!await(0,s.askForSession)())return a(),!1;t=!1}return{success:!0,obfuscateLevel:0,painpoints:[{event:{namespace:"errors",name:"onError"},count:1,kind:"count"},{event:{namespace:"clicks",name:"count_updated"},kind:"comparison",comparisons:[{getter:"count",matcher:6}]}],minified:t}};const o=()=>{var s=[];for(let e=0;e<10;e++){var o=window.performance.now();let t=0;for(let e=0;e<1e6;e++)t+=(t*e+10*e)/(10*e);o=window.performance.now()-o;s.push(o)}let e=0;for(const t of s)e+=t;return!(125<(e/=s.length))};s.askForSession=async()=>{var e,t=await(async()=>{let t=!1;try{await fetch(new Request("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js")).catch(e=>t=!0)}catch(e){t=!0}return t})();try{var s,o=window.performance.now(),n=await fetch(i.BASE_API_URL+"/v1beta/session?hasAdblocker="+t,{credentials:"include",headers:{"X-Auth-Token":window.byteboostKey}});return 199<(e=n.status)&&e<300?(s=await n.json(),window.performance.now()-o>r.MAXIMUM_SESSION_REQUEST_RESPONSE_TIME&&"reuse"!==s.sessionState?(await fetch(i.BASE_API_URL+"/v1beta/session/kill?networkPreflightFailed=true",{credentials:"include",headers:{"X-Auth-Token":window.byteboostKey}}),a(),!1):(localStorage.setItem("bb_sess","true"),!0)):(a(),!1)}catch(e){return!1}}},675:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_PRIORITY=void 0,t.EVENT_PRIORITY={LOGGER:-1,ERRORS:5,SYNC_REQUEST:100,SYNC_REQUEST_CALLBACK:95,ON_SYNC_SKIPPED:90}},429:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uncompressJSON=t.compressJSON=void 0;t.compressJSON=e=>{let n={},r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0,a=1;const c=e=>{var t,s=[];for(t of e)"object"!=typeof t?s.push(t):Array.isArray(t)?s.push(c(t)):s.push(l(t));return s},l=e=>{var t,s={};for(t in e){var o=(e=>{if(e in n)return n[e];let t="";if(i>=r.length&&(i=0,a++),1!==a)for(let e=0;e<a;e++)i+e>=r.length&&(i=0,a++),t+=r[i+e];else t=r[i];var s=`£${t}£`;return i++,n[e]=s})(t);"object"!=typeof e[t]?s[o]=e[t]:Array.isArray(e[t])?s[o]=c(e[t]):s[o]=l(e[t])}return s};var t,e=l(e),s={};for(t in n)s[n[t]]=t;return[e,s]};t.uncompressJSON=(e,n)=>{const r=e=>{var t,s=[];for(t of e)"object"!=typeof t?s.push(t):Array.isArray(t)?s.push(r(t)):s.push(i(t));return s},i=e=>{var t,s={};for(t in e){o=t;var o=n[o];"object"!=typeof e[t]?s[o]=e[t]:Array.isArray(e[t])?s[o]=r(e[t]):s[o]=i(e[t])}return s};return i(e)}},580:(e,l,t)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.cloneObject=void 0;const u=t(601);l.cloneObject=e=>{if("object"!=typeof e)return e;if(Array.isArray(e))return e;let t=(0,u.removeCircular)(e),s={};const o=e=>"object"!=typeof e,n=e=>!!Array.isArray(e),r=e=>e.map(e=>o(e)?e:(n(e)?r:(0,l.cloneObject))(e));var i,a;for(i in t){var c=t[i];a=i,c=c,o(c)?s[a]=c:n(c)?s[a]=r(c):s[a]=(0,l.cloneObject)(t[a])}return s}},765:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebWorker=t.WorkerHandler=void 0;t.WorkerHandler=class{initialized=!1;filePath;workerState={ready:!1,upgrading:!1};currentWorker;workerRegistration;_subscriptions=new Map;_messageQueue=[];constructor(e,t){if("undefined"==typeof window)throw new Error("Unable to initialize service worker on server");window._byteboost_workers||(window._byteboost_workers=new Map);var s=window._byteboost_workers.get(e);if(s)return s;this.filePath=t,window._byteboost_workers.set(e,this)}canCommunicate(){return this.workerState.ready&&!this.workerState.upgrading}on(e,t){this._subscriptions.set(e,t)}emit(e,t){this.currentWorker&&this.canCommunicate()?this.currentWorker.postMessage({id:e,payload:t}):this._messageQueue.push({id:e,payload:t})}onReady(){if(this.workerState.ready=!0,0!==this._messageQueue.length&&this.currentWorker&&this.canCommunicate())for(const e of this._messageQueue)this.emit(e.id,e.payload)}onWorkerMessage(e){var e=e.data,t=this._subscriptions.get(e.id);t&&t(e.payload)}registerWorker(e){this.currentWorker=e,navigator.serviceWorker.removeEventListener("message",e=>{this.onWorkerMessage(e)}),navigator.serviceWorker.addEventListener("message",e=>{this.onWorkerMessage(e)}),this.onReady()}kill(){this.workerRegistration&&this.workerRegistration.unregister()}init(){this.initialized||(this.initialized=!0,navigator&&"serviceWorker"in navigator&&navigator.serviceWorker.register(this.filePath).then(e=>{(this.workerRegistration=e).active&&this.registerWorker(e.active),e.addEventListener("updatefound",()=>{this.workerState.upgrading=!0;const t=e.installing;t&&(t.onstatechange=e=>{"activated"===t.state&&(this.workerState.upgrading=!1,this.workerState.ready=!1,this.registerWorker(t))})})}))}};const s={"screenshot-parser":"https://cdn.jsdelivr.net/npm/@byteboost/inspector-public@latest/dist/public/screenshot.js"};t.WebWorker=class{name;filePath;worker;isActive=!1;_subscriptions=new Map;unsentMessages=[];constructor(e){this.name=e,this.filePath=s[e],this.start()}emit(e,t){this.isActive?this.worker.postMessage({id:e,payload:t}):this.unsentMessages.push({id:e,payload:t})}on(e,t){this._subscriptions.set(e,t)}kill(){this.worker&&this.worker.terminate()}start(){this.worker=new Worker(this.getWorkerUrl()),this.worker.onmessage=e=>{var t=e.data.id,e=e.data.payload;if("_self"===t&&"string"==typeof e&&"active"===e){if(this.isActive=!0,0!==this.unsentMessages.length)for(const s of this.unsentMessages)this.worker.postMessage(s)}else this._subscriptions.has(t)&&this._subscriptions.get(t)(e)}}getWorkerUrl(){var e=`importScripts( "${this.filePath}" );`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}}},924:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPersistantWorker=t.killPersistantWorkers=t.setupPersistantWorkers=void 0;const o=s(765);t.setupPersistantWorkers=async()=>{new o.WorkerHandler("network-tracker","/byteboost.js").init()},t.killPersistantWorkers=async()=>{window._byteboost_workers.forEach(e=>{e.kill()})};t.getPersistantWorker=e=>window._byteboost_workers.get(e)}},n={};(function e(t){var s=n[t];return void 0===s&&(s=n[t]={exports:{}},o[t].call(s.exports,s,s.exports,e)),s.exports})(607)})();
